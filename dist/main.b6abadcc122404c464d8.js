(function(){"use strict";var __webpack_modules__={9665:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){function parse(){var value=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(value.startsWith("="))try{return eval(value.slice(1))}catch(t){return value}return value}__webpack_require__.d(__webpack_exports__,{Q:function(){return parse}})},8186:function(t,e,n){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$el="string"==typeof e?document.querySelector(e):e}var e,n,o;return e=t,(n=[{key:"html",value:function(t){return"string"==typeof t?(this.$el.innerHTML=t,this):this.$el.outerHTML.trim()}},{key:"text",value:function(t){return void 0!==t?(this.$el.textContent=t,this):"input"===this.$el.tagName.toLowerCase()?this.$el.value.trim():this.$el.textContent.trim()}},{key:"clear",value:function(){return this.html(""),this}},{key:"on",value:function(t,e){this.$el.addEventListener(t,e)}},{key:"off",value:function(t,e){this.$el.removeEventListener(t,e)}},{key:"find",value:function(t){return i(this.$el.querySelector(t))}},{key:"append",value:function(e){return e instanceof t&&(e=e.$el),Element.prototype.append?this.$el.append(e):this.$el.appendChild(e),this}},{key:"data",get:function(){return this.$el.dataset}},{key:"closest",value:function(t){return i(this.$el.closest(t))}},{key:"getCoords",value:function(){return this.$el.getBoundingClientRect()}},{key:"findAll",value:function(t){return this.$el.querySelectorAll(t)}},{key:"css",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Object.keys(e);n.forEach((function(n){t.$el.style[n]=e[n]}))}},{key:"getStyles",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((function(e,n){return e[n]=t.$el.style[n],e}),{})}},{key:"id",value:function(t){if(t){var e=this.id().split(":");return{row:+e[0],col:+e[1]}}return this.data.id}},{key:"focus",value:function(){return this.$el.focus(),this}},{key:"attr",value:function(t,e){return e?(this.$el.setAttribute(t,e),this):this.$el.getAttribute(t)}},{key:"addClass",value:function(t){return this.$el.classList.add(t),this}},{key:"removeClass",value:function(t){return this.$el.classList.remove(t),this}}])&&r(e.prototype,n),o&&r(e,o),t}();function i(t){return new o(t)}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}i.create=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=document.createElement(t);return e&&n.classList.add(e),i(n)};var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,r=[{key:"path",get:function(){return window.location.hash.slice(1)}},{key:"param",get:function(){return t.path.split("/")[1]}},{key:"navigate",value:function(t){window.location.hash=t}}],(n=null)&&c(e.prototype,n),r&&c(e,r),t}();function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var l=function(){function t(e,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!e)throw new Error("Selector does not exist");this.$placeholder=i(e),this.routes=n,this.page=null,this.changePlaceHandler=this.changePlaceHandler.bind(this),this.init()}var e,n,r;return e=t,(n=[{key:"init",value:function(){window.addEventListener("hashchange",this.changePlaceHandler),this.changePlaceHandler()}},{key:"changePlaceHandler",value:function(){this.page&&this.page.destroy(),this.$placeholder.clear();var t=u.path.includes("dashboard")||""===u.path?this.routes.dashboard:u.path.includes("excel")?this.routes.excel:this.routes.error;this.page=new t(u.param),this.$placeholder.append(this.page.getRoot()),this.page.afterRender()}},{key:"destroy",value:function(){window.removeEventListener("hashchange",this.changePlaceHandler)}}])&&a(e.prototype,n),r&&a(e,r),t}();function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.params=e}var e,n,r;return e=t,(n=[{key:"getRoot",value:function(){throw new Error('"getRoot" is don\'t')}},{key:"afterRender",value:function(){}},{key:"destroy",value:function(){}}])&&f(e.prototype,n),r&&f(e,r),t}();function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t){t.preventDefault()}function b(t,e){if(t>e){var n=[t,e];e=n[0],t=n[1]}return new Array(e-t+1).fill("").map((function(e,n){return t+n}))}function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e?localStorage.setItem(t,JSON.stringify(e)):JSON.parse(localStorage.getItem(t))}function v(t){return t.replace(/([A-Z])/g,(function(t){return"-".concat(t[0].toLowerCase())}))}function d(t,e){var n;return function(){for(var r=this,o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];var u=function(){clearTimeout(n),t.apply(r,i)};clearTimeout(n),n=setTimeout(u,e)}}var m=["Today at","Yesterday at","2 days ago at","3 days ago at"];function O(t){var e,n=new Date;return m[(e=n-t,Math.floor(e/864e5))]}function g(t){var e=h(t),n=t.split(":")[1];return'<li class="db__record">\n                <a href="#excel/'.concat(n,'">').concat(e.title,"</a>\n                <strong>\n                    ").concat(O(new Date(e.openedDate)),"\n                    ").concat(new Date(e.openedDate).toLocaleTimeString().slice(0,5),"\n                </strong>\n            </li>")}function w(){var t=function(){for(var t=[],e=0;e<localStorage.length;e++){var n=localStorage.key(e);n.includes("excel")&&t.push(n)}return t}();if(!t.length)return"<p>You haven't created anything yet</p>";var e=t.map((function(t){return function(t){return{key:t,openedDate:h(t).openedDate}}(t)})).sort((function(t,e){return t.openedDate>e.openedDate?-1:1})).map((function(t){return t.key}));return'<div class="db__list-header">\n                    <span>Name</span>\n                    <span>Opening date</span>\n                </div>\n                <ul class="db__list">\n                     '.concat(e.map(g).join(""),"\n                </ul>")}function _(t){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function j(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function k(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function P(t,e){return(P=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function S(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=x(t);if(e){var o=x(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return E(this,n)}}function E(t,e){return!e||"object"!==_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function x(t){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var R=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&P(t,e)}(c,t);var e,n,r,o=S(c);function c(){return j(this,c),o.apply(this,arguments)}return e=c,(n=[{key:"getRoot",value:function(){var t=Date.now().toString();return i.create("div","db").html('\n            <div class="db__header">\n                <h1>Dynamic sheets!</h1>\n            </div>\n    \n            <div class="db__new">\n                <div class="db__view">\n                    <a href="#excel/'.concat(t,'" class="db__create">\n                        Create a new table\n                    </a>\n                </div>\n            </div>\n    \n            <div class="db__table db__view">\n                ').concat(w(),"\n            </div>\n        "))}}])&&k(e.prototype,n),r&&k(e,r),c}(s);function D(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var T=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.listeners={}}var e,n,r;return e=t,(n=[{key:"emit",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return!!Array.isArray(this.listeners[t])&&(this.listeners[t].forEach((function(t){t.apply(void 0,n)})),!0)}},{key:"subscribe",value:function(t,e){var n=this;return this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(e),function(){n.listeners[t]=n.listeners[t].filter((function(t){return t!==e}))}}}])&&D(e.prototype,n),r&&D(e,r),t}();function $(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var C=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.store=e,this.sub=null,this.prevState={}}var e,n,r;return e=t,(n=[{key:"subscribeComponents",value:function(t){var e=this;this.prevState=this.store.getState(),this.sub=this.store.subscribe((function(n){Object.keys(n).forEach((function(r){var o,i;o=e.prevState[r],i=n[r],("object"===p(o)&&"object"===i?JSON.stringify(o)===JSON.stringify(i):o===i)||t.forEach((function(t){if(t.isWatching(r)){var e=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},r,n[r]);t.storeChanged(e)}}))})),e.prevState=e.store.getState()}))}},{key:"unsubscribeFromStore",value:function(){this.sub.unsubscribe()}}])&&$(e.prototype,n),r&&$(e,r),t}(),A="TABLE_RESIZE",L="CHANGE_TEXT",N="APPLY_STYLE",q="CHANGE_STYLES",B="CHANGE_TITLE",I="UPDATE_DATE";function H(t){return{type:A,data:t}}function M(t){return{type:L,data:t}}function J(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var z=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.components=e.components||[],this.store=e.store,this.emitter=new T,this.subscriber=new C(this.store)}var e,n,r;return e=t,(n=[{key:"getRoot",value:function(){var t=i.create("div","excel"),e={emitter:this.emitter,store:this.store};return this.components=this.components.map((function(n){var r=i.create("div",n.className),o=new n(r,e);return r.html(o.toHTML()),t.append(r),o})),t}},{key:"init",value:function(){document.addEventListener("contextmenu",y),this.store.dispatch({type:I}),this.subscriber.subscribeComponents(this.components),this.components.forEach((function(t){return t.init()}))}},{key:"destroy",value:function(){this.subscriber.unsubscribeFromStore(),this.components.forEach((function(t){return t.destroy()})),document.removeEventListener("contextmenu",y)}}])&&J(e.prototype,n),r&&J(e,r),t}();function W(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function G(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function K(t){return"on"+("string"!=typeof(e=t)?"":e.charAt(0).toUpperCase()+e.slice(1));var e}function U(t){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function F(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Q(t,e){return(Q=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=V(t);if(e){var o=V(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return X(this,n)}}function X(t,e){return!e||"object"!==U(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function V(t){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var tt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Q(t,e)}(i,t);var e,n,r,o=Z(i);function i(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Y(this,i),(e=o.call(this,t,n.listeners)).name=n.name,e.emitter=n.emitter,e.subscribe=n.subscribe||[],e.store=n.store,e.unsubscribers=[],e.prepare(),e}return e=i,(n=[{key:"prepare",value:function(){}},{key:"toHTML",value:function(){return""}},{key:"$emit",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(e=this.emitter).emit.apply(e,[t].concat(r))}},{key:"$on",value:function(t,e){var n=this.emitter.subscribe(t,e);this.unsubscribers.push(n)}},{key:"$dispatch",value:function(t){this.store.dispatch(t)}},{key:"storeChanged",value:function(){}},{key:"isWatching",value:function(t){return this.subscribe.includes(t)}},{key:"init",value:function(){this.initDOMListeners()}},{key:"destroy",value:function(){this.removeDOMListeners(),this.unsubscribers.forEach((function(t){return t()}))}}])&&F(e.prototype,n),r&&F(e,r),i}(function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(W(this,t),!e)throw new Error("Do not is $root for DomListener");this.$root=e,this.listeners=n}var e,n,r;return e=t,(n=[{key:"initDOMListeners",value:function(){var t=this;this.listeners.forEach((function(e){var n=K(e);if(!t[n])throw new Error("Method ".concat(n," is not implemented in ").concat(t.name||"Unknown"," Component"));t[n]=t[n].bind(t),t.$root.on(e,t[n])}))}},{key:"removeDOMListeners",value:function(){var t=this;this.listeners.forEach((function(e){var n=K(e);t.$root.off(e,t[n])}))}}])&&G(e.prototype,n),r&&G(e,r),t}()),et={textAlign:"left",fontWeight:"normal",textDecoration:"none",fontStyle:"normal"},nt="New table";function rt(t){return(rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function it(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ct(t,e){return(ct=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ut(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=lt(t);if(e){var o=lt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return at(this,n)}}function at(t,e){return!e||"object"!==rt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function lt(t){return(lt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ft(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var st=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ct(t,e)}(c,t);var e,n,r,o=ut(c);function c(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),o.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ot(Object(n),!0).forEach((function(e){ft(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({name:"Header",listeners:["input","click"]},e))}return e=c,(n=[{key:"prepare",value:function(){this.onInput=d(this.onInput,300)}},{key:"toHTML",value:function(){var t=this.store.getState().title||nt;return'<input type="text" class="input" value="'.concat(t,'"/>\n        <div>\n            <div class="button" data-button="remove">\n                <i class="material-icons" data-button="remove">delete_outline</i>\n            </div>\n            <div class="button" data-button="exit">\n                <i class="material-icons" data-button="exit">exit_to_app</i>\n            </div>\n        </div>')}},{key:"onInput",value:function(t){var e,n=i(t.target);this.$dispatch((e=n.text(),{type:B,data:e}))}},{key:"onClick",value:function(t){var e,n=i(t.target);"exit"===n.data.button?u.navigate(""):"remove"===n.data.button&&confirm("Are you sure you want to delete the table?")&&(e="excel:".concat(u.param),localStorage.removeItem(e),u.navigate(""))}}])&&it(e.prototype,n),r&&it(e,r),c}(tt);function pt(t){var e=JSON.stringify(t.value),n='\n        data-type="button"\n        data-value=\''.concat(e,"'\n    ");return'<div\n                class="button '.concat(t.action?"active":"",'"\n                ').concat(n,'>\n            <i class="material-icons">').concat(t.icon,"</i>\n        </div>")}function yt(t){return(yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ht(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bt(Object(n),!0).forEach((function(e){vt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function vt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ot(t,e){return(Ot=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function gt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=_t(t);if(e){var o=_t(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wt(this,n)}}function wt(t,e){return!e||"object"!==yt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _t(t){return(_t=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jt(t){return(jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function St(t,e,n){return(St="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Dt(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Et(t,e){return(Et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function xt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Dt(t);if(e){var o=Dt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Rt(this,n)}}function Rt(t,e){return!e||"object"!==jt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dt(t){return(Dt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}ft(st,"className","excel__header");var $t=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Et(t,e)}(c,t);var e,n,r,o=xt(c);function c(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),o.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?kt(Object(n),!0).forEach((function(e){Tt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({name:"Toolbar",listeners:["click"],subscribe:["currentStyles"]},e))}return e=c,(n=[{key:"init",value:function(){var t=this;St(Dt(c.prototype),"init",this).call(this),this.$on("toolbar:select",(function(e){var n=Object.keys(e)[0];t.setState(Tt({},n,e[n]))}))}},{key:"prepare",value:function(){this.initState(et)}},{key:"template",get:function(){return[{icon:"format_align_left",action:"left"===(t=this.state).textAlign,value:{textAlign:"left"}},{icon:"format_align_center",action:"center"===t.textAlign,value:{textAlign:"center"}},{icon:"format_align_right",action:"right"===t.textAlign,value:{textAlign:"right"}},{icon:"format_bold",action:"bold"===t.fontWeight,value:{fontWeight:"bold"===t.fontWeight?"normal":"bold"}},{icon:"format_italic",action:"italic"===t.fontStyle,value:{fontStyle:"italic"===t.fontStyle?"normal":"italic"}},{icon:"format_underlined",action:"underline"===t.textDecoration,value:{textDecoration:"underline"===t.textDecoration?"none":"underline"}}].map(pt).join("");var t}},{key:"toHTML",value:function(){return this.template}},{key:"storeChanged",value:function(t){this.setState(t.currentStyles)}},{key:"onClick",value:function(t){var e=i(t.target);if(function(t){return"button"===t.target.dataset.type}(t)){var n=JSON.parse(e.data.value);this.$emit("toolbar:applyStyle",n)}}}])&&Pt(e.prototype,n),r&&Pt(e,r),c}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ot(t,e)}(i,t);var e,n,r,o=gt(i);function i(){dt(this,i);for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return o.call.apply(o,[this].concat(e))}return e=i,(n=[{key:"template",get:function(){return JSON.stringify(this.state,null,2)}},{key:"initState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state=ht({},t)}},{key:"setState",value:function(t){this.state=ht(ht({},this.state),t),this.$root.html(this.template)}}])&&mt(e.prototype,n),r&&mt(e,r),i}(tt));function Ct(t){return(Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function At(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Nt(t,e,n){return(Nt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ht(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function qt(t,e){return(qt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Bt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ht(t);if(e){var o=Ht(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return It(this,n)}}function It(t,e){return!e||"object"!==Ct(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ht(t){return(Ht=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Tt($t,"className","excel__toolbar");var Jt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qt(t,e)}(c,t);var e,n,r,o=Bt(c);function c(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),o.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?At(Object(n),!0).forEach((function(e){Mt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):At(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({name:"Formula",listeners:["input","keydown"],subscribe:["currentText"]},e))}return e=c,(n=[{key:"toHTML",value:function(){return'<div class="info">fx</div>\n                <div id="formula" class="input" contenteditable spellcheck="false"></div>'}},{key:"init",value:function(){var t=this;Nt(Ht(c.prototype),"init",this).call(this),this.$formula=this.$root.find("#formula"),this.$on("table:select",(function(e){t.$formula.text(e.data.value)}))}},{key:"storeChanged",value:function(t){var e=t.currentText;this.$formula.text(e)}},{key:"onKeydown",value:function(t){var e=t.key;["Enter","Tab"].includes(e)&&!t.shiftKey&&(t.preventDefault(),this.$emit("formula:keyEnter",t))}},{key:"onInput",value:function(t){this.$emit("formula:input",i(t.target).text())}},{key:"focus",value:function(){this.input.focus()}}])&&Lt(e.prototype,n),r&&Lt(e,r),c}(tt);Mt(Jt,"className","excel__formula");var zt=n(9665);function Wt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Gt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Wt(Object(n),!0).forEach((function(e){Kt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Wt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Kt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ut=65,Yt=90;function Ft(t,e){return(t[e]||120)+"px"}function Qt(t,e){return function(n,r){var o="".concat(e,":").concat(r),i=Ft(t.colState,r),c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(t).map((function(e){return"".concat(v(e),": ").concat(t[e])})).join(";")}(Gt(Gt({},et),t.stylesState[o])),u=t.dataState[o];return'<div\n            class="cell"\n            contenteditable\n            data-col="'.concat(r,'"\n            data-type="cell"\n            data-id="').concat(o,'"\n            data-value="').concat(u||"",'"\n            style="').concat(c,"; width: ").concat(i,'"\n        >').concat((0,zt.Q)(u)||"","</div>")}}function Zt(t){var e=t.col,n=t.index,r=t.width;return'<div class="column" data-type="resizable" data-col="'.concat(n,'" data-all="col" style="width: ').concat(r,'">\n            ').concat(e,'\n            <div class="col-resize" data-resize="col"></div>\n        </div>')}function Xt(t,e,n){var r=t?'<div class="row-resize" data-resize="row"></div>':"",o=function(t,e){return(t[e]||24)+"px"}(n,t);return'\n        <div\n            class="row"\n            '.concat(t?'data-type="resizable"':"",'\n            data-row="').concat(t,'"\n            style="height: ').concat(o,'"\n        >\n            <div\n                class="row-info">\n                ').concat(t||"","\n                ").concat(r,'\n            </div>\n            <div class="row-data">').concat(e,"</div>\n        </div>\n")}function Vt(t,e){return String.fromCharCode(Ut+e)}function te(t){return function(e,n){return{col:e,index:n,width:Ft(t.colState,n)}}}function ee(t,e){return new Promise((function(n){var r,o=i(e.target),c=o.closest('[data-type="resizable"]'),u=o.data.resize,a=c.getCoords(),l="col"===u?"bottom":"right";o.css(function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({opacity:1},l,"-5000px")),document.onmousemove=function(t){if("col"===u){var e=t.pageX-a.right;r=a.width+e,o.css({right:-e+"px"})}else{var n=t.pageY-a.bottom-window.scrollY;r=a.height+n,o.css({bottom:-n+"px"})}},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,"col"===u?(c.css({width:r+"px"}),t.findAll('[data-col="'.concat(c.data.col,'"]')).forEach((function(t){return t.style.width=r+"px"}))):c.css({height:r+"px"}),n({value:r,type:u,id:c.data[u]}),o.css({opacity:0,bottom:0,right:0})}}))}function ne(t){return t.id(!0)}function re(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var oe=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.group=[],this.current=null}var e,n,r;return e=t,(n=[{key:"select",value:function(e){this.clear(),e.focus().addClass(t.className),this.group.push(e),this.current=e}},{key:"clear",value:function(){this.group.map((function(e){return e.removeClass(t.className)})),this.group=[]}},{key:"add",value:function(){this.group.map((function(e){return e.addClass(t.className)}))}},{key:"selectedIds",get:function(){return this.group.map((function(t){return t.id()}))}},{key:"selectGroup",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.clear(),this.group=t,this.add()}},{key:"applyStyle",value:function(t){this.group.forEach((function(e){return e.css(t)}))}}])&&re(e.prototype,n),r&&re(e,r),t}();function ie(t){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ce(t,e,n,r,o,i,c){try{var u=t[i](c),a=u.value}catch(t){return void n(t)}u.done?e(a):Promise.resolve(a).then(r,o)}function ue(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ae(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function le(t,e,n){return(le="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ye(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function fe(t,e){return(fe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function se(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ye(t);if(e){var o=ye(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pe(this,n)}}function pe(t,e){return!e||"object"!==ie(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ye(t){return(ye=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function be(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(oe,"className","selected");var he=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fe(t,e)}(a,t);var e,n,r,o,c,u=se(a);function a(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),u.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ue(Object(n),!0).forEach((function(e){be(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({name:"Table",listeners:["mousedown","input","keydown"]},e))}return e=a,(n=[{key:"toHTML",value:function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:25,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Yt-Ut+1,r=[],o=new Array(n).fill("").map(Vt).map(te(e)).map(Zt).join("");r.push(Xt(null,o,{}));for(var i=0;i<t;i++){var c=new Array(n).fill("").map(Qt(e,i)).join("");r.push(Xt(i+1,c,e.rowState))}return r.join("")}(20,this.store.getState())}},{key:"prepare",value:function(){this.selection=new oe}},{key:"init",value:function(){var t=this;le(ye(a.prototype),"init",this).call(this);var e=this.$root.find('[data-id="0:0"]');this.selectCell(e),this.$on("formula:input",(function(e){t.selection.current.attr("data-value",e).text((0,zt.Q)(e)),t.updateTextInStore(e)})),this.$on("table:input",(function(e){t.updateTextInStore(e)})),this.$on("formula:keyEnter",(function(e){t.onKeydown(e),t.$emit("table:select",t.selection.current)})),this.$on("toolbar:applyStyle",(function(e){var n;t.selection.applyStyle(e),t.$dispatch((n={value:e,ids:t.selection.selectedIds},{type:N,data:n}))}))}},{key:"selectCell",value:function(t){this.selection.select(t),this.$emit("table:select",t),this.$emit("toolbar:select",t.getStyles(Object.keys(et)));var e=t.getStyles(Object.keys(et));this.$dispatch({type:q,data:e})}},{key:"resizeTable",value:(o=regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ee(this.$root,e);case 3:n=t.sent,this.$dispatch(H(n)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.warn("ERROR RESIZE: ",t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])})),c=function(){var t=this,e=arguments;return new Promise((function(n,r){var i=o.apply(t,e);function c(t){ce(i,n,r,c,u,"next",t)}function u(t){ce(i,n,r,c,u,"throw",t)}c(void 0)}))},function(t){return c.apply(this,arguments)})},{key:"onMousedown",value:function(t){var e,n,r,o,c,u,a=this;if(function(t,e){return"col"===t.target.dataset.all}(t)){var l=function(t,e){var n=[],r=e.target.dataset.col;return t.findAll('[data-col="'.concat(r,'"]')).forEach((function(t){return n.push(t)})),n.map((function(t){return i(t)}))}(this.$root,t);this.selection.selectGroup(l)}if(function(t){return t.target.dataset.resize}(t))t.preventDefault(),this.resizeTable(t);else if(function(t){return"cell"===t.target.dataset.type}(t)){var f=i(t.target);if(t.shiftKey){var s=(e=f,n=this.selection.current,r=ne(e),o=ne(n),c=b(o.col,r.col),u=b(o.row,r.row),c.reduce((function(t,e){return u.forEach((function(n){return t.push("".concat(n,":").concat(e))})),t}),[])).map((function(t){return a.$root.find('[data-id="'.concat(t,'"]'))}));this.selection.selectGroup(s)}else this.selectCell(f)}}},{key:"updateTextInStore",value:function(t){this.$dispatch(M({id:this.selection.current.id(),value:t}))}},{key:"updateTextInStoreTwo",value:function(t){this.$dispatch(M({id:this.selection.current.id(),value:t}))}},{key:"onInput",value:function(t){this.updateTextInStore(i(t.target).text())}},{key:"onKeydown",value:function(t){var e=t.key;if(["Enter","Tab","ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].includes(e)&&!t.shiftKey){t.preventDefault();var n=this.selection.current.id(!0),r=this.$root.find(function(t,e){var n=e.col,r=e.row;switch(t){case"Enter":case"ArrowDown":r++;break;case"Tab":case"ArrowRight":n++;break;case"ArrowLeft":n-1<0||n--;break;case"ArrowUp":r-1<0||r--}return'[data-id="'.concat(r,":").concat(n,'"]')}(e,n));this.selectCell(r)}}}])&&ae(e.prototype,n),r&&ae(e,r),a}(tt);function ve(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function de(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ve(Object(n),!0).forEach((function(e){me(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function me(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ge(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Oe(Object(n),!0).forEach((function(e){we(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Oe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function we(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _e(t,e){var n,r,o;switch(e.type){case A:return r="col"===e.data.type?"colState":"rowState",ge(ge({},t),{},we({},r,je(t,r,e)));case L:return r="dataState",ge(ge({},t),{},we({currentText:e.data.value},r,je(t,r,e)));case q:return ge(ge({},t),{},{currentStyles:e.data});case N:return o=t[r="stylesState"]||{},e.data.ids.forEach((function(t){o[t]=ge(ge({},o[t]),e.data.value)})),ge(ge({},t),{},(we(n={},r,o),we(n,"currentStyles",ge(ge({},t.currentStyles),e.data.value)),n));case B:return ge(ge({},t),{},{title:e.data});case I:return ge(ge({},t),{},{openedDate:(new Date).toJSON()});default:return t}}function je(t,e,n){var r=t[e]||{};return r[n.data.id]=n.data.value,r}function ke(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Pe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ke(Object(n),!0).forEach((function(e){Se(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Se(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}be(he,"className","excel__table");var Ee={title:nt,rowState:{},colState:{},dataState:{},stylesState:{},currentText:"",currentStyles:et,openedDate:(new Date).toJSON()};function xe(t){return t?function(t){return Pe(Pe({},t),{},{currentStyles:et,currentText:""})}(t):(e=Ee,JSON.parse(JSON.stringify(e)));var e}function Re(t){return(Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function De(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Te(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $e(t,e){return($e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ce(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Le(t);if(e){var o=Le(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ae(this,n)}}function Ae(t,e){return!e||"object"!==Re(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Le(t){return(Le=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ne(t){return"excel:".concat(t)}function qe(t){return(qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Be(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ie(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function He(t,e){return(He=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Me(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ze(t);if(e){var o=ze(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Je(this,n)}}function Je(t,e){return!e||"object"!==qe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ze(t){return(ze=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}new l("#app",{dashboard:R,excel:function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$e(t,e)}(i,t);var e,n,r,o=Ce(i);function i(){return De(this,i),o.apply(this,arguments)}return e=i,(n=[{key:"getRoot",value:function(){var t=this.params?this.params:Date.now().toString(),e=function(t){var e=t(de({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),{type:"__INIT__"}),n=[];return{subscribe:function(t){return n.push(t),{unsubscribe:function(){n=n.filter((function(e){return e!==t}))}}},dispatch:function(r){e=t(e,r),n.forEach((function(t){return t(e)}))},getState:function(){return JSON.parse(JSON.stringify(e))}}}(_e,xe(h(Ne(t)))),n=d((function(e){h(Ne(t),e)}),300);return e.subscribe(n),this.excel=new z({components:[st,$t,Jt,he],store:e}),this.excel.getRoot()}},{key:"afterRender",value:function(){this.excel.init()}},{key:"destroy",value:function(){this.excel.destroy()}}])&&Te(e.prototype,n),r&&Te(e,r),i}(s),error:function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&He(t,e)}(c,t);var e,n,r,o=Me(c);function c(){return Be(this,c),o.apply(this,arguments)}return e=c,(n=[{key:"getRoot",value:function(){return i.create("div","db").html('\n        <div class="error">\n            <div class="error__text">\n                 <h2>An error has occurred. Invalid table hash</h2>\n                 <img class="img" src="Snake.png" alt="">\n            </div>\n            <h3 class="error__return">\n                <a href="#dashboard">\n                    Go back to main page\n                </a>\n            </h3>\n        </div>\n        ')}}])&&Ie(e.prototype,n),r&&Ie(e,r),c}(s)}),console.log("Work")}},__webpack_module_cache__={},deferred;function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](n,n.exports,__webpack_require__),n.exports}__webpack_require__.m=__webpack_modules__,deferred=[],__webpack_require__.O=function(t,e,n,r){if(!e){var o=1/0;for(a=0;a<deferred.length;a++){e=deferred[a][0],n=deferred[a][1],r=deferred[a][2];for(var i=!0,c=0;c<e.length;c++)(!1&r||o>=r)&&Object.keys(__webpack_require__.O).every((function(t){return __webpack_require__.O[t](e[c])}))?e.splice(c--,1):(i=!1,r<o&&(o=r));if(i){deferred.splice(a--,1);var u=n();void 0!==u&&(t=u)}}return t}r=r||0;for(var a=deferred.length;a>0&&deferred[a-1][2]>r;a--)deferred[a]=deferred[a-1];deferred[a]=[e,n,r]},__webpack_require__.d=function(t,e){for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t={179:0};__webpack_require__.O.j=function(e){return 0===t[e]};var e=function(e,n){var r,o,i=n[0],c=n[1],u=n[2],a=0;for(r in c)__webpack_require__.o(c,r)&&(__webpack_require__.m[r]=c[r]);if(u)var l=u(__webpack_require__);for(e&&e(n);a<i.length;a++)o=i[a],__webpack_require__.o(t,o)&&t[o]&&t[o][0](),t[i[a]]=0;return __webpack_require__.O(l)},n=self.webpackChunk=self.webpackChunk||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}(),__webpack_require__.O(void 0,[202],(function(){return __webpack_require__(1202)}));var __webpack_exports__=__webpack_require__.O(void 0,[202],(function(){return __webpack_require__(8186)}));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();
